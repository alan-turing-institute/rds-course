
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Module 2: Hands-on session &#8212; Research Data Science</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Module 2: Hands-on session (Solutions)" href="hands-on-complete.html" />
    <link rel="prev" title="2.2.7 Missing Data" href="2.2.7-MissingData.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Research Data Science</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../index.html">
   Welcome!
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Module 1: Introduction to Data Science
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../m1/overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m1/1.1-WhatIsDataScience.html">
   1.1 What is [research] data science?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m1/1.2-DataScienceProjectLifecycle.html">
   1.2 Research Data Science project lifecycle
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m1/1.3-EDIForDataScience.html">
   1.3 Equality, diversity and inclusion in data science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m1/1.4-CollaborationAndReproducibility.html">
   1.4 Collaboration and reproducibility
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m1/hands-on.html">
   Module 1: Hands-on session
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Module 2: Handling data
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="2.1-GettingLoading.html">
   2.1 Getting and Loading Data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="2.1.1-WhereToFindData.html">
     2.1.1 Where to find data?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2.1.2-LegalityAndEthics.html">
     2.1.2 Legality and Ethics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2.1.3-PandasIntro.html">
     2.1.3 Pandas intro
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2.1.4-DataSourcesAndFormats.html">
     2.1.4 Data Sources and Formats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2.1.5-ControllingAccess.html">
     2.1.5 Controlling access
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="2.2-DataWrangling.html">
   2.2 Data Wrangling
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="2.2.1-DataConsistency.html">
     2.2.1 Data Consistency
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2.2.2-ModifyingColumnsAndIndices.html">
     2.2.2 Modifying Columns and Indices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2.2.3-FeatureEngineering.html">
     2.2.3 Feature Engineering
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="2.2.4-DataManipulation.html">
     2.2.4 Data Manipulation
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
    <label for="toctree-checkbox-3">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="2.2.4.1-TimeAndDateData.html">
       2.2.4.1 Time and Date Data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="2.2.4.2-TextData.html">
       2.2.4.2 Text data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="2.2.4.3-CategoricalData.html">
       2.2.4.3 Categorical Data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="2.2.4.4-ImageData.html">
       2.2.4.4 Image Data
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2.2.5-PrivacyAndAnonymisation.html">
     2.2.5 Privacy and Anonymisation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2.2.6-LinkingDatasets.html">
     2.2.6 Linking Datasets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2.2.7-MissingData.html">
     2.2.7 Missing Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Module 2: Hands-on session
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hands-on-complete.html">
   Module 2: Hands-on session (Solutions)
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Module 3: Data Visualisation &amp; Exploration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../m3/overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m3/3.1-FiguresGoneWrong.html">
   3.1 Figures gone wrong
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m3/3.2-RulesOfTheGame.html">
   3.2 Rules of the data visualisation game
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m3/3.3-Atlas0fVisualisations.html">
   3.3 Atlas of Visualisations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m3/3.4-StoryTelling.html">
   3.4 Storytelling with data visualisation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m3/3.5-DataVisForExploration.html">
   3.5 Walkthrough: visualisation for data exploration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m3/hands-on.html">
   Module 3 hands-on session
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Module 4: Introduction to Modelling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../m4/overview.html">
   Overview
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m4/4.1-WhatAndWhy.html">
   4.1 The What and Why of Statistical Modelling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m4/4.2-ModelFitting.html">
   4.2 Fitting (Regression) Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m4/4.3-ModelBuilding.html">
   4.3 Building a simple model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m4/4.4-ModelEvaluation.html">
   4.4 Evaluating models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../m4/hands-on.html">
   Module 4 hands-on session
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/modules/m2/hands-on.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/alan-turing-institute/rds-course"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/alan-turing-institute/rds-course/issues/new?title=Issue%20on%20page%20%2Fmodules/m2/hands-on.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/alan-turing-institute/rds-course/develop?urlpath=tree/coursebook/modules/m2/hands-on.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-the-notebook">
   Running the notebook
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prerequisites">
     Prerequisites
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#clone-the-course-repository">
     Clone the Course Repository
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-local-python-environment">
     Create a Local Python Environment
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#managing-python-versions">
     Managing Python Versions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-a-virtual-environment-with-poetry">
     Creating a Virtual Environment with
     <code class="docutils literal notranslate">
      <span class="pre">
       Poetry
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jupyter">
     Jupyter
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#download-data">
   Download Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebook-setup">
   Notebook Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploring-the-downloaded-files">
   Exploring the Downloaded Files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pandas-help">
   Pandas Help
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-and-explore">
   Load and Explore
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#different-data-types">
   Different Data Types
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#making-things-more-readable">
   Making Things More Readable
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#self-reported-health">
   Self-Reported Health
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#missing-values">
   Missing Values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vs-2011">
   2007 vs 2011
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uk-vs-spain">
   UK vs Spain
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#your-turn">
   Your Turn!
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Module 2: Hands-on session</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-the-notebook">
   Running the notebook
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#prerequisites">
     Prerequisites
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#clone-the-course-repository">
     Clone the Course Repository
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-local-python-environment">
     Create a Local Python Environment
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#managing-python-versions">
     Managing Python Versions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#creating-a-virtual-environment-with-poetry">
     Creating a Virtual Environment with
     <code class="docutils literal notranslate">
      <span class="pre">
       Poetry
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jupyter">
     Jupyter
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#download-data">
   Download Data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#notebook-setup">
   Notebook Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploring-the-downloaded-files">
   Exploring the Downloaded Files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pandas-help">
   Pandas Help
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-and-explore">
   Load and Explore
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#different-data-types">
   Different Data Types
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#making-things-more-readable">
   Making Things More Readable
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#self-reported-health">
   Self-Reported Health
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#missing-values">
   Missing Values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#vs-2011">
   2007 vs 2011
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#uk-vs-spain">
   UK vs Spain
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#your-turn">
   Your Turn!
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="module-2-hands-on-session">
<h1>Module 2: Hands-on session<a class="headerlink" href="#module-2-hands-on-session" title="Permalink to this headline">¶</a></h1>
<p>In this hands-on notebook we’ll be getting familiar with working with the <a class="reference external" href="https://beta.ukdataservice.ac.uk/datacatalogue/studies/study?id=7724#%21/access-data">European Quality of Life data</a> in pandas by:</p>
<ul class="simple">
<li><p>Creating a Local Python Environment</p></li>
<li><p>Downloading the data</p></li>
<li><p>Loading and exploring the data</p></li>
<li><p>Understanding the different data types present</p></li>
<li><p>Making the data more readable</p></li>
<li><p>Considering how missing data is represented</p></li>
<li><p>Exploring some differences between the 2007 and 2011 data</p></li>
<li><p>Comparing data from UK and Spain respondees with respect to data missingness</p></li>
</ul>
<p>We have marked the exercise parts of this notebook as <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">TODO</span></code> with some comments as guidance. You can refer back to the taught material, or external documentation, for further information.</p>
<div class="section" id="running-the-notebook">
<h2>Running the notebook<a class="headerlink" href="#running-the-notebook" title="Permalink to this headline">¶</a></h2>
<div class="section" id="prerequisites">
<h3>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h3>
<p>To setup and run the commands in this notebook you will need a (preferably bash/similar) shell with these installed:</p>
<ul class="simple">
<li><p>Python 3.7 or later</p>
<ul>
<li><p>Check by running <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">--version</span></code> or <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">--version</span></code> in your shell</p></li>
</ul>
</li>
<li><p>Git (optional)</p>
<ul>
<li><p>Check by running <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">--version</span></code> in your shell</p></li>
</ul>
</li>
<li><p>Curl (optional)</p>
<ul>
<li><p>Check by running <code class="docutils literal notranslate"><span class="pre">curl</span> <span class="pre">--version</span></code> in your shell</p></li>
</ul>
</li>
</ul>
<p>If you don’t have these we have instructions in our <a class="reference external" href="https://alan-turing-institute.github.io/rse-course/html/course_prerequisites/index.html">Research Software Engineering course</a>.</p>
</div>
<div class="section" id="clone-the-course-repository">
<h3>Clone the Course Repository<a class="headerlink" href="#clone-the-course-repository" title="Permalink to this headline">¶</a></h3>
<p>In order to work locally with this notebook, you should clone the course repository.</p>
<ol>
<li><p>Go to the GitHub repository in a web browser: <a class="reference external" href="https://github.com/alan-turing-institute/rds-course">https://github.com/alan-turing-institute/rds-course</a></p></li>
<li><p>Click on the green “Code” button and copy the address under “Clone - HTTPS”.</p></li>
<li><p>In your shell, run the following command from a sensible location (this will create a new dir for the course in current dir):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/alan-turing-institute/rds-course.git
</pre></div>
</div>
</li>
<li><p>Change directory to the repository root</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>rds-course
</pre></div>
</div>
</li>
<li><p>We’re currently using the <code class="docutils literal notranslate"><span class="pre">develop</span></code> branch, so check that out</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>checkout<span class="w"> </span>develop
</pre></div>
</div>
</li>
</ol>
<p><strong>Troubleshooting:</strong></p>
<ul class="simple">
<li><p><strong>If you don’t have <code class="docutils literal notranslate"><span class="pre">git</span></code>:</strong> We recommend using git, but if you don’t have it installed you can download a zip of the code by clicking on “Download Zip” in step 2 above instead, and unpack it locally.</p></li>
<li><p><strong>If you previously cloned/downloaded the repo:</strong> Please run <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">develop</span></code> and then <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code> from the <code class="docutils literal notranslate"><span class="pre">rds-course</span></code> directory to ensure you have the latest version of the material.</p></li>
</ul>
</div>
<div class="section" id="create-a-local-python-environment">
<h3>Create a Local Python Environment<a class="headerlink" href="#create-a-local-python-environment" title="Permalink to this headline">¶</a></h3>
<p>We need to install third-party packages necessary for the course, with the same package versions as it was developed with to ensure compatibility and reproducibility.</p>
</div>
<div class="section" id="managing-python-versions">
<h3>Managing Python Versions<a class="headerlink" href="#managing-python-versions" title="Permalink to this headline">¶</a></h3>
<p>As well as the versions of packages your codebase should specify which version(s) of Python itself that it’s compatible with. The code for this course should run with Python 3.7 or above. We don’t cover it here to speedup setup, but if you need to use multiple versions of Python on your system we recommend <a class="reference external" href="https://github.com/pyenv/pyenv">Pyenv</a> and <a class="reference external" href="https://conda.io/projects/conda/en/latest/index.html">Conda</a>.</p>
</div>
<div class="section" id="creating-a-virtual-environment-with-poetry">
<h3>Creating a Virtual Environment with <code class="docutils literal notranslate"><span class="pre">Poetry</span></code><a class="headerlink" href="#creating-a-virtual-environment-with-poetry" title="Permalink to this headline">¶</a></h3>
<p>The Python ecosystem has many different ways of managing packaging and installing dependencies (<a class="reference external" href="https://packaging.python.org/key_projects/#pipenv">this page</a> lists somem). The most well-known is <code class="docutils literal notranslate"><span class="pre">pip</span></code> with dependencies listed in a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file.</p>
<p>In this course we use the tool <a class="reference external" href="https://python-poetry.org/">Poetry</a>, which can help manage <a class="reference external" href="https://python-poetry.org/docs/managing-environments/">multiple environments</a>, in particular <a class="reference external" href="https://python-poetry.org/docs/managing-environments/#switching-between-environments">switching between environments </a>.</p>
<p>Dependencies are listed in <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code> and have versions fixed in <code class="docutils literal notranslate"><span class="pre">poetry.lock</span></code>. <code class="docutils literal notranslate"><span class="pre">Poetry</span></code> will pick these files up and install the required packages in a predictable manner, and into a virtual environment isolated from other projects on your system.</p>
<ol>
<li><p>Install <code class="docutils literal notranslate"><span class="pre">Poetry</span></code> by following their instructions <a class="reference external" href="https://python-poetry.org/docs/#installation">here</a>.</p></li>
<li><p>Change to the <code class="docutils literal notranslate"><span class="pre">rds-course</span></code> directory (the directory of the git repository cloned above), if you’re  not there already:
cd /path/to/rds-course</p></li>
<li><p>Set the relevant Python executable for Poetry to use:</p>
<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">--version</span></code> returns a version number of 3.7 or above:</p>
<ul>
<li><p>Skip to step 4</p></li>
</ul>
</li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">--version</span></code> is less than 3.7 (e.g., 2.7), but <code class="docutils literal notranslate"><span class="pre">python3</span> <span class="pre">--version</span></code> gives 3.7 or above:</p>
<ul>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">poetry</span> <span class="pre">env</span> <span class="pre">use</span> <span class="pre">python3</span></code></p></li>
</ul>
</li>
<li><p>If you have a Python 3.7+ environment available somewhere else:</p>
<ul>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">poetry</span> <span class="pre">env</span> <span class="pre">use</span> <span class="pre">/full/path/to/python</span></code></p></li>
</ul>
</li>
<li><p>If you don’t have Python 3.7+ installed or don’t know where to find it:</p>
<ul>
<li><p>Refer back to the instructions in the prerequisites and/or ask for help.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Run the following command to create the virtual environment and install the third-party packages necessary for the course:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>install
</pre></div>
</div>
</li>
<li><p>Check the details of the virtual environment that’s been created:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>env<span class="w"> </span>info
</pre></div>
</div>
</li>
<li><p>Initialise the environment:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poetry<span class="w"> </span>shell
</pre></div>
</div>
</li>
</ol>
<p>The last step creates a new shell setup to use the Python virtual environment we just created (e.g., <code class="docutils literal notranslate"><span class="pre">which</span> <span class="pre">python</span></code>, should now show the path returned earlier by <code class="docutils literal notranslate"><span class="pre">poetry</span> <span class="pre">env</span> <span class="pre">info</span></code> above, rather the path to your global Python executable). If you want to stop using the virtual environment <code class="docutils literal notranslate"><span class="pre">exit</span></code> the shell.</p>
<p><strong>Troubleshooting:</strong></p>
<ul class="simple">
<li><p><strong>If you don’t have <code class="docutils literal notranslate"><span class="pre">curl</span></code></strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">curl</span></code> is used to download a Python script (currently <a class="reference external" href="https://raw.githubusercontent.com/python-poetry/poetry/master/get-poetry.py">this script</a> but check the <a class="reference external" href="https://python-poetry.org/docs/#installation">Poetry documentation</a> for the latest URL). Save this script as <code class="docutils literal notranslate"><span class="pre">get-poetry.py</span></code> and then run <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">get-poetry.py</span></code> to install Poetry.</p></li>
</ul>
</li>
<li><p><strong>If you don’t want to use <code class="docutils literal notranslate"><span class="pre">Poetry</span></code></strong>:</p>
<ul>
<li><p>You can install the course dependencies by running <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">.</span></code> from the <code class="docutils literal notranslate"><span class="pre">rds-course</span></code> directory, but we recommend doing this in an alternative virtual environment of your choice (not in your global Python installation).</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="jupyter">
<h3>Jupyter<a class="headerlink" href="#jupyter" title="Permalink to this headline">¶</a></h3>
<p>We recommend use of <a class="reference external" href="https://jupyter.org/">JupyterLab</a> for running through the hands-on notebooks in this course.</p>
<p>JuypyterLab was installed into your Poetry environment in the previous step. We can launch a local instance, from the poetry environment terminal, with:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>jupyter<span class="w"> </span>lab<span class="w"> </span><span class="c1"># from the root of the cloned github repository! &quot;rds-course&quot; directory</span>
</pre></div>
</div>
<p>We recommend following the rest of the notebook via the JupyterLab instance that should spawn!</p>
<p>Click through the file explorer in the left-hand pane to bring up this notebook.</p>
<p>The notebook should be present at: <code class="docutils literal notranslate"><span class="pre">rds-course/coursebook/modules/m2/2-hands-on.ipynb</span></code></p>
<p>If you’ve not used <code class="docutils literal notranslate"><span class="pre">Jupyter</span></code> before you might find their <a class="reference external" href="https://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Notebook%20Basics.html">Notebook basics</a> and <a class="reference external" href="https://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Running%20Code.html">Running code</a> documentation helpful.</p>
</div>
</div>
<div class="section" id="download-data">
<h2>Download Data<a class="headerlink" href="#download-data" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>As described in module 1, we can find the data available for download from the UK Data Service <a class="reference external" href="https://beta.ukdataservice.ac.uk/datacatalogue/studies/study?id=7724#%21/access-data">here</a></p></li>
<li><p>Observe the licence and take this opportunity to check your obligations</p></li>
<li><p>Download the CSV data</p></li>
<li><p>Unzip the data to <code class="docutils literal notranslate"><span class="pre">$PROJECT_ROOT/data</span></code> this should give us <code class="docutils literal notranslate"><span class="pre">$PROJECT_ROOT/data/UKDA-7724-csv</span></code></p></li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">$PROJECT_ROOT</span></code> is the root of the cloned github repository for this course. If you change the directory that you hold this data in, you’ll need to make appropriate changes to the <code class="docutils literal notranslate"><span class="pre">DATA_ROOT_PATH</span></code> variable below.</p>
</div>
<div class="section" id="notebook-setup">
<h2>Notebook Setup<a class="headerlink" href="#notebook-setup" title="Permalink to this headline">¶</a></h2>
<p>Import necessary packages for this work:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># these are utility functions to check some answers in the notebook</span>
<span class="kn">from</span> <span class="nn">handson_utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">parse_country_values_2011</span><span class="p">,</span>
    <span class="n">check_dataset_load</span><span class="p">,</span>
    <span class="n">check_dataset_explored</span><span class="p">,</span>
    <span class="n">check_column_mapping</span><span class="p">,</span>
    <span class="n">set_column_mapping</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Define path to data. This relies on the data being saved in the specified location below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATA_ROOT_PATH</span> <span class="o">=</span> <span class="s2">&quot;../m4/data/UKDA-7724-csv&quot;</span> <span class="c1"># should match the path you unzipped the data to</span>

<span class="n">COMBINED_CSV_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ROOT_PATH</span><span class="p">,</span> <span class="s2">&quot;csv/eqls_2007and2011.csv&quot;</span><span class="p">)</span>
<span class="n">MAPPING_CSV_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ROOT_PATH</span><span class="p">,</span> <span class="s2">&quot;mrdoc/excel/eqls_api_map.csv&quot;</span><span class="p">)</span>

<span class="c1"># consts for loading categorical data value maps</span>
<span class="n">CATEGORICAL_VALUES_XLSX_PATH</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ROOT_PATH</span><span class="p">,</span> <span class="s2">&quot;mrdoc/excel/eqls_concordance_grid.xlsx&quot;</span><span class="p">)</span>
<span class="n">CATEGORICAL_VALUES_XLSX_SHEET_NAME</span> <span class="o">=</span> <span class="s2">&quot;Values&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exploring-the-downloaded-files">
<h2>Exploring the Downloaded Files<a class="headerlink" href="#exploring-the-downloaded-files" title="Permalink to this headline">¶</a></h2>
<p>Take some time to familiarise yourself with the file structure of the downloaded files (in the <code class="docutils literal notranslate"><span class="pre">UKDA-7724-csv</span></code> directory), opening them in Excel/Numbers/relevant application of your choice initially. In particular:</p>
<ul class="simple">
<li><p>The table of files <code class="docutils literal notranslate"><span class="pre">mrdoc/excel/7724_file_information_csv.csv</span></code></p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">csv</span></code> directory</p>
<ul>
<li><p>What data does each file contain?</p></li>
</ul>
</li>
<li><p>The user guide <code class="docutils literal notranslate"><span class="pre">mrdoc/pdf/7724_eqls_2007-2011_user_guide_v2.pdf</span></code></p></li>
<li><p>The “Variables” and “Values” worksheet in <code class="docutils literal notranslate"><span class="pre">mrdoc/excel/eqls_concordance_grid.xlsx</span></code></p>
<ul>
<li><p>How many variables are there? Can they be grouped in any way?</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pandas-help">
<h2>Pandas Help<a class="headerlink" href="#pandas-help" title="Permalink to this headline">¶</a></h2>
<p>You’ll be using pandas for most of the hands-on session. In each question there’s a list of sections from the teaching material that may give you hints for how to approach them.</p>
<p>You might also like to refer to the Pandas documentation:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/user_guide">User Guide</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf">Cheat Sheet</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/reference">API Reference</a></p></li>
</ul>
<p>Or you can get a function’s documentation in the notebook by:</p>
<ul class="simple">
<li><p>Hitting SHIFT + TAB in a code cell with your text cursor on a function name.</p></li>
<li><p>Running <code class="docutils literal notranslate"><span class="pre">help(&lt;function_name&gt;)</span></code> in a code cell (e.g. <code class="docutils literal notranslate"><span class="pre">help(pd.read_csv)</span></code></p></li>
</ul>
</div>
<div class="section" id="load-and-explore">
<h2>Load and Explore<a class="headerlink" href="#load-and-explore" title="Permalink to this headline">¶</a></h2>
<p><em><strong>Relevant sections:</strong></em> <em>2.1.4 (Data Sources and Formats), 2.2.1 (Data Consistency)</em></p>
<p>Read the combined 2007 and 2011 data into a pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code></p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO read in the file and display the head</span>

<span class="c1"># your code here</span>
<span class="n">df</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># checks - will produce an `AssertionError` until DataFrame loaded correctly</span>
<span class="n">check_dataset_load</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Take a look at some summary statistics and use these to assign the variables below correctly.</p>
<p>You can assign the variables manually from inspecting printed output or assign them results from methods/properties.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO - code to explore dataframe can go here</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO - fill in the below with the correct values</span>
<span class="n">n_columns</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># how many columns are there in the DataFrame? Does this match number of variables you expected?</span>
<span class="n">n_float64_columns</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># how many columns are of dtype float64?</span>
<span class="n">Y11_Q31_mean_value</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#  what is the mean of the values in the Y11_Q31 column?</span>
<span class="n">Y11_Country_n_unique</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># how many unique values in the Y11_Country column?</span>


<span class="c1"># function to check your answers (run this cell)</span>
<span class="n">check_dataset_explored</span><span class="p">(</span>
    <span class="n">n_columns</span><span class="p">,</span>
    <span class="n">n_float64_columns</span><span class="p">,</span>
    <span class="n">Y11_Q31_mean_value</span><span class="p">,</span>
    <span class="n">Y11_Country_n_unique</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="different-data-types">
<h2>Different Data Types<a class="headerlink" href="#different-data-types" title="Permalink to this headline">¶</a></h2>
<p><em><strong>Relevant Sections:</strong></em> <em>2.2.1 (Data Consistency)</em></p>
<p>Are there columns containing the following types of data? If so give examples.</p>
<ul class="simple">
<li><p>Numeric data (without a set of pre-defined categories)</p></li>
<li><p>Binary data</p></li>
<li><p>Categorical data, unordered</p></li>
<li><p>Categorical data, ordered</p></li>
<li><p>Text data</p></li>
<li><p>Time or date data</p></li>
</ul>
<p><strong>Note:</strong></p>
<ul class="simple">
<li><p>The dataset contains at least 4 of these, try to have another look if you found fewer.</p></li>
<li><p>You’ll need to refer to the dataset documentation to fully understand which columns contain which types (<code class="docutils literal notranslate"><span class="pre">mrdoc/excel/eqls_concordance_grid.xlsx</span></code> may be helpful, in particlar).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
<p>For one example of each type, what are the possible values the data can take, according to the documentation? What does each value mean? Is each possible value present in the dataset?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
<p>What is the minimum, maximum and mean value in each of your example columns? Taking into consideration the type of data in the column, are all of these values meaningful?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
<p>For one of the categorical columns, replace the numerical encodings with their actual meaning (category title). You can do this by manually creating a Python dictionary with the values to replace (we’ll look at extracting them with code later). What is the most common value?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="making-things-more-readable">
<h2>Making Things More Readable<a class="headerlink" href="#making-things-more-readable" title="Permalink to this headline">¶</a></h2>
<p><em><strong>Relevant Sections:</strong></em> <em>2.2.2 (Modifying Columns and Indices), 2.2.4.2 (Text Data)</em></p>
<p>At the moment, we’ve got column headings such as <code class="docutils literal notranslate"><span class="pre">'Y11_Country'</span></code>, <code class="docutils literal notranslate"><span class="pre">'Y11_Q31'</span></code> and <code class="docutils literal notranslate"><span class="pre">'Y11_Q32'</span></code> in our data. These aren’t particularly helpful at a glance and we’d need to do some cross-referencing with <code class="docutils literal notranslate"><span class="pre">eqls_api_map.csv</span></code> to make sense of them.</p>
<p>To make things more readable, let’s rename our columns according to the <code class="docutils literal notranslate"><span class="pre">'VariableLabel'</span></code> column in <code class="docutils literal notranslate"><span class="pre">mrdoc/excel/eqls_api_map.csv</span></code>.</p>
<p>However, because it can make <code class="docutils literal notranslate"><span class="pre">.</span></code> access a bit tricky, we’d like to make sure we don’t have any spaces or non-word characters in our new column names! For consistency, we’d like everything to be lower case.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># we have to explicitly use latin1 encoding as the file is not saved in utf-8 (our platform default)</span>
<span class="n">eqls_api_map_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">MAPPING_CSV_PATH</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin1&#39;</span><span class="p">)</span>
<span class="n">eqls_api_map_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>TODO:</p>
<ul class="simple">
<li><p>replace column names in <code class="docutils literal notranslate"><span class="pre">df</span></code> with corresponding entry in <code class="docutils literal notranslate"><span class="pre">'VariableLabel'</span></code> column from <code class="docutils literal notranslate"><span class="pre">eqls_api_map_df</span></code></p></li>
<li><p>ensure all column names are entirely lowercase</p></li>
<li><p>ensure only characters [a-zA-Z0-9_] are present in column names</p>
<ul>
<li><p>remove apostrophes (<code class="docutils literal notranslate"><span class="pre">&quot;'&quot;</span></code>)</p></li>
<li><p>replace otherwise non-matching (e.g., whitespace or <code class="docutils literal notranslate"><span class="pre">'/'</span></code>) character with <code class="docutils literal notranslate"><span class="pre">'_'</span></code></p></li>
<li><p>we don’t want consecutive <code class="docutils literal notranslate"><span class="pre">'_'</span></code> characters (e.g., <code class="docutils literal notranslate"><span class="pre">no_of_children</span></code> rather than <code class="docutils literal notranslate"><span class="pre">no__of_children</span></code>)</p></li>
</ul>
</li>
<li><p>keep a map (python <code class="docutils literal notranslate"><span class="pre">dict</span></code>) that shows the old -&gt; new column mapping in case we ever want to invert this transformation.</p></li>
</ul>
<p>Example manual mapping (you should produce this with a general code solution!):</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span>{
    ...,
    &#39;Y11_Q32&#39; -&gt; &#39;no_of_children&#39;
    ...,
    &#39;Y11_Q67_4&#39; -&gt; &#39;citizenship_dont_know&#39;,
    ...,
}
</pre></div>
</div>
<p>You may find it helpful to use a site like <a class="reference external" href="https://regex101.com/">regex101</a> to experiment with creating a
suitable regex expression.</p>
<p>⚠️ <strong>Note:</strong> ⚠️ This is a reasonably tricky regex question. If you prefer to move on to the following questions there is a code cell you can run below to set the updated column names.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
<span class="n">column_mapping</span> <span class="o">=</span> <span class="p">{}</span>


<span class="c1"># TODO</span>
<span class="c1"># Apply your column mapping to df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check your answer</span>
<span class="n">check_column_mapping</span><span class="p">(</span><span class="n">column_mapping</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If you would like to skip this question, uncomment the code and run this cell:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">### THIS CODE MODIFIES df TO THE EXPECTED RESULT AFTER THE MAKING THINGS MORE READABLE EXERCISE</span>

<span class="c1"># !!! uncomment the line below and run the cell to set the answer !!!</span>
<span class="c1"># df = set_column_mapping(df, eqls_api_map_df)</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="self-reported-health">
<h2>Self-Reported Health<a class="headerlink" href="#self-reported-health" title="Permalink to this headline">¶</a></h2>
<p><em><strong>Relevant Sections:</strong></em> <em>2.2.1 (Data Consistency), 2.2.3 (Feature Engineering), 2.2.4.3 (Categorical Data)</em></p>
<p>The research question we defined in Module 1 and will explore in more detail in Modules 3 and 4 aims to explore the contribution of various factors on self-reported health.</p>
<p>Which column in the dataset contains self-reported health values? How many people had “Very good” self-reported health?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
<p>For the models we develop in Module 4 we’ll convert self-reported health into a binary variable. What might be a sensible way to group the categories into only two possible values? Create a new column with your proposed binary encoding for self-reported health.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="missing-values">
<h2>Missing Values<a class="headerlink" href="#missing-values" title="Permalink to this headline">¶</a></h2>
<p><em><strong>Relevant Sections:</strong></em> <em>2.2.1 (Data Consistency), 2.2.7 (Missing Data)</em></p>
<p>There are at least three different ways missing data and unknown information are represented in this dataset.</p>
<p>Look at one row of the data. What value does Pandas use to represent missing data? How many missing values are there in the row you picked?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
<p>Looking at the possible values for each column in the dataset documentation, find two different columns and at least two different values that are also used to represent missing or unknown information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
<p>For the columns you picked:</p>
<ul class="simple">
<li><p>How many missing values does Pandas say the column has?</p></li>
<li><p>How many values match the numeric representation of missing data you found from the documentation (e.g., if the documentation says -99 means unknown, how many -99 values are there in the column)?</p></li>
<li><p>Does Pandas include the numeric representation in its count of missing values?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
<p>Replace the numbers representing missing values in the columns you picked with the <code class="docutils literal notranslate"><span class="pre">NaN</span></code> type from <code class="docutils literal notranslate"><span class="pre">numpy</span></code>. What is the Pandas count of missing values now?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
<p>Are there different types of missing data in the dataset (different reasons values can be unknown)? Does this have any implications for the way you would analyse the data?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="vs-2011">
<h2>2007 vs 2011<a class="headerlink" href="#vs-2011" title="Permalink to this headline">¶</a></h2>
<p><em><strong>Relevant Sections:</strong></em> <em>2.2.1 (Data Consistency), 2.2.7 (Missing Data)</em></p>
<ul class="simple">
<li><p>Which column should be used to distinguish between the collection years? (2007 and 2011)</p></li>
<li><p>How many rows do we have for each year?</p></li>
<li><p>For each collection year, what % of null values do we have for each column?</p>
<ul>
<li><p>Why is this?</p></li>
<li><p>Display these %s in descending  order sorted by: 2007 then 2011</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="uk-vs-spain">
<h2>UK vs Spain<a class="headerlink" href="#uk-vs-spain" title="Permalink to this headline">¶</a></h2>
<p>Further to the missing data we saw above, grouped by wave/year, how do missing values look for each country of collection?</p>
<p>Compare the UK with Spain:</p>
<ul class="simple">
<li><p>are there columns that have all values for one country but some are missing for the other?</p></li>
<li><p>are there columns that don’t have any values for one country but at least some are present for the other?</p></li>
</ul>
<p>What implications are there from your answers to the above questions?</p>
<p>For simplicity, just look at 2011 data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_2011</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Some code for parsing the data in mrdoc/excel/eqls_concordance_grid.xlsx&quot;</span>
<span class="c1"># E.g. country data is categorically encoded in our DataFrame but not human readable</span>
<span class="c1"># We can get the human readable categories from this file</span>


<span class="c1"># load the categorical value data from excel workbook, specifying the appropriate sheet</span>
<span class="n">cat_vals_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">CATEGORICAL_VALUES_XLSX_PATH</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">CATEGORICAL_VALUES_XLSX_SHEET_NAME</span><span class="p">)</span>

<span class="c1"># display head</span>
<span class="n">cat_vals_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>You can write your own function to extract the data you need from the <code class="docutils literal notranslate"><span class="pre">cat_vals_df</span></code> dataframe, input it manually, or use our prewritten function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">country_mapping_2011</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># TODO</span>


<span class="c1"># uncomment beow if you want to use our pre-written function to parse the data for country mappings</span>
<span class="c1">#country_mapping_2011 = parse_country_values_2011(categorical_values_df=cat_vals_df)</span>

<span class="c1"># display</span>
<span class="n">country_mapping_2011</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO - Null values in UK vs Spain</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="your-turn">
<h2>Your Turn!<a class="headerlink" href="#your-turn" title="Permalink to this headline">¶</a></h2>
<p>We now leave it to you to learn something interesting from the dataset, using any of the techniques we’ve learned. You could attempt to explore questions like the ones below, for example, but pick anything that appeals to you. Always take care to consider whether the values you’ve calculated are likely to be representative.</p>
<ul class="simple">
<li><p>Which age group is most optimistic about the future?</p></li>
<li><p>Which country has the most trust in the police? And the least?</p></li>
<li><p>Are there differences between genders for the highest level of education completed? Does this vary by country and/or age group?</p></li>
</ul>
<p>If you prefer, you could also do this with one of the example datasets we used during teaching:</p>
<ul class="simple">
<li><p>World Bank percentage of people living in urban environments (<span class="xref myst">Section 2.1.4 Data Sources and Formats</span>)</p></li>
<li><p>Palmer Penguins dataset (<span class="xref myst">Section 2.2.1 Data Consistency</span>)</p></li>
<li><p>Anthropometric Survey of US Army Personnel (<span class="xref myst">Section 2.2.3 Feature Engineering</span>)</p></li>
<li><p>New York Patient Characteristics Survey (<span class="xref myst">Section 2.2.4.3 Categorical Data</span>)</p></li>
</ul>
<p>These datasets are stored in the <code class="docutils literal notranslate"><span class="pre">coursebook/modules/m2/data</span></code> directory, but you may prefer to download the original versions as we made modifications for teaching.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># TODO</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "alan-turing-institute/rds-course",
            ref: "develop",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./modules/m2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="2.2.7-MissingData.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">2.2.7 Missing Data</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="hands-on-complete.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Module 2: Hands-on session (Solutions)</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Research Engineering Group, The Alan Turing Institute<br/>
    
        &copy; Copyright 2021.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>